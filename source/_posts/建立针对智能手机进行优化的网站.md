---
layout: post
title: 建立针对智能手机进行优化的网站
date: 2014-04-21 11:21:04
tags: 优化
---

推荐详情

对于针对智能手机进行优化的网站，Google支持以下三种配置：

采用响应性网页设计的网站，也就是使用同一组网址在所有设备上显示相应内容的网站，其中各网址会为所有设备提供相同的HTML，且仅使用CSS来调整网页在设备上的呈现方式。这是Google推荐的配置。
通过同一组网址向所有设备动态提供相应内容的网站，但各网址会根据用户代理是桌面设备还是移动设备而分别提供不同的HTML（和CSS）。
具有单独的移动版网址和桌面版网址的网站。
下面我们将介绍如何实现上述各种配置。

响应性网页设计

采用这种设置（响应性网页设计）时，服务器始终会向所有设备发送相同的HTML代码，并且系统会通过CSS来更改网页在使用媒体查询的设备上的呈现方式。如果所有的Googlebot用户代理都可以抓取网页资源（CSS、JavaScript以及图片），那么我们的算法应能自动检测此设置。

对于智能手机，我们推荐使用以下CSS媒体查询：

@media only screen and (max-width: 640px) {...}  //移动优先
以上所示的最大宽度值640像素只是一个示例，而不是强制性的要求。我们的算法会寻找可合理预期的最大宽度值来指代智能手机屏幕分辨率，而且我们会尝试监控典型的移动网站使用的值，以便将来对我们的算法进行相应的更新。

至于如何指定媒体查询，Google支持相应标准允许的在代码中使用使用媒体查询的各种方式。每种实现方式都各有利弊，您可以选择一种最适合您的网站和用户的方式。一般来说，如果您的网站可以在最新版的浏览器（如 Google Chrome 浏览器或 Apple Mobile Safari）中运行，那么该网站就可以使用我们的算法。

如需获得有关响应性网页设计方面的更多帮助，您可以先阅读网站站长中心上的这篇博文。

为什么要使用响应性设计

我们推荐使用响应性网页设计是因为它有许多优势：

针对同一份内容使用单一网址不仅可让用户更轻松地与该内容进行互动、分享并链接到该内容，而且有助于Google的算法为该内容分配索引属性。
无需重定向即可将用户定向到已针对设备进行优化的视图，从而可缩短加载时间。此外，基于用户代理的重定向不仅容易出错，而且会使网站的用户体验大打折扣（有关详情，请参见“检测用户代理时的常见问题”部分）。
为您的网站和Google的抓取工具节省资源。对于采用响应性网页设计的网页，任何Googlebot用户代理只需抓取这些网页一次（与使用不同的用户代理时抓取多次的情况相反），即可检索到相应内容。提高抓取效率可间接协助Google将更多的网站内容编入索引，并确保抓取的内容是最新的。
抓取要求

请勿使用robots.txt或以其他方式阻止任何Googlebot抓取网页资源（CSS、JavaScript以及图片）。能够完全访问这些外部文件有助于我们的算法检测网站的响应性网页设计配置，并对其进行适当处理。

通过同一网址动态提供不同的HTML

采用这种设置（动态提供内容）时，服务器会根据请求相应网页的用户代理通过同一网址提供不同的HTML（和CSS）。采用这种设置时，网站针对移动用户代理对HTML进行的更改不会立即生效（移动内容处于“隐藏”状态），因此，我们建议服务器发送一个提示，以便要求针对智能手机的Googlebot也应抓取相应网页，从而发现移动内容。此提示是使用Vary HTTP标头实现的。

Vary HTTP标头

Vary HTTP标头具有以下两个非常重要且实用的作用：

它会向ISP和其他位置使用的缓存服务器表明：在决定是否通过缓存来提供网页时它们应考虑用户代理。如果您没有使用Vary HTTP标头，缓存可能会错误地向移动设备用户提供桌面版HTML网页的缓存（反之亦然）。
它有助于Googlebot更快速地发现针对移动设备进行优化的内容，这是因为有效的Vary HTTP标头是我们可以用来抓取以下网址的信号之一：提供针对移动设备进行优化的内容的网址。
Vary HTTP标头是服务器对请求做出的响应的一部分，如下所示：
```
GET /page-1 HTTP/1.1
Host: www.example.com
(...rest of HTTP request headers...)

HTTP/1.1 200 OK
Content-Type: text/html
Vary: User-Agent
Content-Length: 5710
(... rest of HTTP response headers...)
```
这意味着，响应的内容将根据请求相应网页的用户代理而异。如果您的服务器已使用Vary HTTP标头，那么您可以向已提供的列表添加“用户代理”。

请确保您了解检测用户代理时的常见问题，当您在网站上设置动态提供内容时应考虑这些内容。

单独的移动版网址

采用此配置时，每个桌面版网址都具有一个对等的不同网址（用于提供针对移动设备进行优化的内容）。常见设置为：www.example.com上为桌面设备用户提供内容的网页具有相应的m.example.com网页（为移动设备用户提供内容）。Google并不偏向于任何特定网址格式，相应格式只要可供所有Googlebot访问即可。

针对桌面版和移动版网址的注释

为了帮助我们的算法了解您网站上的这种配置，我们建议您使用以下注释：

在桌面版网页上，添加指向相应移动版网址的特殊链接rel=”alternate”标记。这有助于Googlebot发现网站的移动版网页所在的位置。
在移动版网页上，添加指向相应桌面版网址的链接rel=”canonical”标记。
我们支持采用以下两种方法添加此注释：在网页本身的HTML中，以及在站点地图中。例如，假设桌面版网址为http://example.com/page-1且相应的移动版网址为http://m.example.com/page-1。那么此示例中的注释如下所示：

HTML中的注释

在桌面版网页上，添加：
```
<link rel="alternate" media="only screen and (max-width: 640px)"
      href="http://m.example.com/page-1" >
 ```
而在移动版网页上，所需的注释应为：
```
<link rel="canonical" href="http://www.example.com/page-1" >
```
此移动版网址中指向桌面版网页的rel=”canonical”标记是必需的。

站点地图中的注释

我们支持按以下方式在站点地图中为桌面版网页添加rel=”alternate”注释：
```
<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
        xmlns:xhtml="http://www.w3.org/1999/xhtml">
<url>
<loc>http://www.example.com/page-1/</loc>
<xhtml:link
    rel="alternate"
    media="only screen and (max-width: 640px)"
    href="http://m.example.com/page-1" />
</url>
</urlset>
```
仍应将移动版网址中必需的rel=”canonical”标记添加到移动版网页的HTML中。

详细注释

请注意桌面版网页中链接标记的属性：

rel=”alternate”属性用于表明此标记指定了指向桌面版网页的备选网址。
媒体属性的值是一个CSS媒体查询字符串，用于指定将应用备选网址的媒体功能。在本例中，我们使用的是通常用于定位智能手机的媒体查询。
href属性用于指定备选网址的位置，也就是m.example.com上的网页。
这种双向注释有助于Googlebot发现您的内容，并协助我们的算法了解桌面版网页与移动版网页之间的关系，从而对它们进行相应的处理。当您使用不同的网址以不同格式提供相同内容时，该注释可让Google的算法知道这两个网址具有同等的内容，应将它们视为一个（而非两个）实体。如果将桌面版和移动版网址分开处理，那么这两个网址会同时出现在桌面版搜索结果中，而它们的排名可能会低于作为一个实体时的排名。

重定向和HTTP Vary标头

请注意，如果您的网站自动将使用移动设备访问桌面版网站的访问者重定向到移动版网站（反之亦然），请务必按照本部分中的说明将您的服务器配置为包含Vary HTTP标头。





